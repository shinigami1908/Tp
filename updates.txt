def upload_all_report_cards(base_dir: Optional[Path] = None) -> Optional[Dict[str, Any]]:
    if base_dir is None:
        base_dir = Path(".")

    output_dir = base_dir / "output"
    output_dir.mkdir(parents=True, exist_ok=True)

    log.info("Building report_cards for all employees...")
    all_reports = build_all_reports(base_dir=base_dir)
    if not all_reports:
        log.error("No report cards built; aborting upload.")
        return None

    # âžœ Unique filename per upload
    timestamp = datetime.datetime.utcnow().strftime("%Y%m%d_%H%M%S")
    report_filename = f"report_cards_all_{timestamp}.json"
    report_path = output_dir / report_filename

    try:
        with open(report_path, "w", encoding="utf-8") as f:
            json.dump(all_reports, f, indent=2, default=str)
        log.info("Wrote %s to %s", report_filename, report_path)
    except Exception as e:
        log.exception("Failed to write %s: %s", report_filename, e)
        return None

    tfm = TachyonFileManager()

    try:
        log.info("Uploading %s to Tachyon file API...", report_filename)
        response_obj = tfm.upload_file_s3(str(report_path))
        log.info("Upload response: %s", response_obj)

        # Extract ID only if exists
        new_file_id = None
        if isinstance(response_obj, dict):
            new_file_id = response_obj.get("id")

        if new_file_id:
            log.info("Uploaded new Tachyon file_id: %s", new_file_id)
            try:
                (output_dir / "tachyon_last_file_id.txt").write_text(new_file_id, encoding="utf-8")
            except Exception as e:
                log.warning("Could not store last_file_id: %s", e)
        else:
            log.warning("Upload did not return an 'id'. Possibly a duplicate or validation error.")

        return response_obj

    except Exception as e:
        log.exception("Failed to upload %s: %s", report_filename, e)
        return None
