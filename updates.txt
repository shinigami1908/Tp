# --- Ensure all "*__rows" columns are numeric ints (fixes release_metrics__rows being empty string) ---
rows_cols = [c for c in merged_all.columns if c.endswith("__rows")]
for rc in rows_cols:
    try:
        merged_all[rc] = pd.to_numeric(merged_all[rc], errors="coerce").fillna(0).astype(int)
    except Exception:
        # final fallback: convert to int by manual fill
        merged_all[rc] = merged_all[rc].apply(lambda x: int(float(x)) if (pd.notna(x) and str(x).strip()!='') else 0)
# --- end rows normalization ---
